<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>æƒ…ç»ªæ”¯æŒåŠ©æ‰‹</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="ä¸€ä¸ªç»¼åˆæ€§çš„æƒ…ç»ªæ”¯æŒåº”ç”¨ï¼Œåœ¨å›°éš¾æ—¶åˆ»é€šè¿‡ç…§ç‰‡ã€éŸ³é¢‘å’Œæ­£é¢å›å¿†æä¾›å®‰æ…°">
    <meta name="keywords" content="æƒ…ç»ªæ”¯æŒ,å¿ƒç†å¥åº·,å†¥æƒ³,æ”¾æ¾,æƒ…ç»ªç®¡ç†,å¿ƒç†è¾…åŠ©">
    <meta name="author" content="Emotional Support Team">
    
    <!-- PWA Display -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="EmotionalSupport">
    <meta name="application-name" content="EmotionalSupport">
    <meta name="msapplication-TileColor" content="#EC4899">
    <meta name="msapplication-config" content="/browserconfig.xml">
    
    <!-- Theme Colors -->
    <meta name="theme-color" content="#EC4899">
    <meta name="msapplication-navbutton-color" content="#EC4899">
    <meta name="apple-mobile-web-app-status-bar-style" content="#EC4899">
    
    <!-- Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Favicons and Icons -->
    <link rel="icon" type="image/png" sizes="16x16" href="/icon-48x48.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icon-48x48.png">
    <link rel="icon" type="image/png" sizes="48x48" href="/icon-48x48.png">
    <link rel="icon" type="image/png" sizes="72x72" href="/icon-72x72.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/icon-96x96.png">
    <link rel="icon" type="image/png" sizes="128x128" href="/icon-128x128.png">
    <link rel="icon" type="image/png" sizes="144x144" href="/icon-144x144.png">
    <link rel="icon" type="image/png" sizes="152x152" href="/icon-152x152.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="384x384" href="/icon-384x384.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/icon-512x512.png">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/icon-72x72.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/icon-72x72.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/icon-96x96.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/icon-128x128.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/icon-128x128.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icon-192x192.png">
    
    <!-- Windows Tiles -->
    <meta name="msapplication-TileImage" content="/icon-144x144.png">
    <meta name="msapplication-square70x70logo" content="/icon-72x72.png">
    <meta name="msapplication-square150x150logo" content="/icon-152x152.png">
    <meta name="msapplication-wide310x150logo" content="/icon-384x384.png">
    <meta name="msapplication-square310x310logo" content="/icon-384x384.png">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="æƒ…ç»ªæ”¯æŒåŠ©æ‰‹ - Emotional Support Assistant">
    <meta property="og:description" content="åœ¨å›°éš¾æ—¶åˆ»æä¾›æƒ…ç»ªæ”¯æŒå’Œå®‰æ…°çš„åº”ç”¨">
    <meta property="og:image" content="/icon-512x512.png">
    <meta property="og:url" content="https://your-domain.netlify.app">
    <meta property="og:site_name" content="Emotional Support Assistant">
    <meta property="og:locale" content="zh_CN">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="æƒ…ç»ªæ”¯æŒåŠ©æ‰‹">
    <meta name="twitter:description" content="åœ¨å›°éš¾æ—¶åˆ»æä¾›æƒ…ç»ªæ”¯æŒå’Œå®‰æ…°çš„åº”ç”¨">
    <meta name="twitter:image" content="/icon-512x512.png">
    
    <!-- Security Headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    
    <!-- Preconnect to improve performance -->
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://images.unsplash.com">
    
    <!-- External Libraries -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- CSS for PWA -->
    <style>
        /* Prevent zoom on iOS */
        input, select, textarea {
            font-size: 16px !important;
        }
        
        /* Hide scrollbars in PWA mode */
        @media all and (display-mode: standalone) {
            body {
                -webkit-user-select: none;
                -webkit-touch-callout: none;
                -webkit-tap-highlight-color: transparent;
            }
        }
        
        /* Ensure full height on mobile */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        
        /* Loading screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #FDF2F8 0%, #FCE7F3 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }
        
        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #EC4899;
            border-top: 4px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            margin-top: 20px;
            color: #EC4899;
            font-size: 18px;
            font-weight: 600;
        }
        
        /* Install prompt styles */
        .install-prompt {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #EC4899;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            z-index: 1000;
            display: none;
            font-size: 14px;
            font-weight: 500;
        }
        
        .install-prompt.show {
            display: block;
            animation: slideUp 0.3s ease-out;
        }
        
        @keyframes slideUp {
            from { transform: translateX(-50%) translateY(100px); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-spinner"></div>
        <div class="loading-text">æƒ…ç»ªæ”¯æŒåŠ©æ‰‹æ­£åœ¨å¯åŠ¨...</div>
    </div>
    
    <!-- Install Prompt -->
    <div id="install-prompt" class="install-prompt">
        <span>å®‰è£…åº”ç”¨åˆ°ä¸»å±å¹•ï¼Œéšæ—¶è·å¾—æ”¯æŒ ğŸ’</span>
        <button onclick="installApp()" style="margin-left: 10px; background: white; color: #EC4899; border: none; padding: 4px 12px; border-radius: 12px; font-weight: 600;">å®‰è£…</button>
        <button onclick="dismissInstall()" style="margin-left: 5px; background: rgba(255,255,255,0.2); color: white; border: none; padding: 4px 8px; border-radius: 12px;">Ã—</button>
    </div>
    
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // ç®€å•çš„SVGå›¾æ ‡ç»„ä»¶
        const Heart = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
            </svg>
        );

        const Camera = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                <circle cx="12" cy="13" r="4"/>
            </svg>
        );

        const Mic = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
                <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                <line x1="12" y1="19" x2="12" y2="23"/>
                <line x1="8" y1="23" x2="16" y2="23"/>
            </svg>
        );

        const MessageCircle = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
            </svg>
        );

        const Globe = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="2" y1="12" x2="22" y2="12"/>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
            </svg>
        );

        // æ–°å¢æ–‡æ¡£å›¾æ ‡
        const FileText = ({ className }) => (
          <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14,2 14,8 20,8"/>
            <line x1="16" y1="13" x2="8" y2="13"/>
            <line x1="16" y1="17" x2="8" y2="17"/>
            <line x1="10" y1="9" x2="8" y2="9"/>
          </svg>
        );

        // æ–°å¢æ‹–æ‹½æ‰‹æŸ„å›¾æ ‡
        const DragHandle = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="currentColor">
                <path d="M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
            </svg>
        );

        const EmotionalSupportApp = () => {
          const [currentView, setCurrentView] = useState('main');
          const [sosMode, setSosMode] = useState('photo');
          const [mixedMode, setMixedMode] = useState('photo-audio'); // 'photo-audio' æˆ– 'memory-audio'
          const [currentIndex, setCurrentIndex] = useState(0);
          const [language, setLanguage] = useState('zh');
          const [photoDuration, setPhotoDuration] = useState(12);
          const [uploadedAudios, setUploadedAudios] = useState([]);
          const [uploadedPhotos, setUploadedPhotos] = useState([]);
          const [defaultPhotos, setDefaultPhotos] = useState([
            { 
              id: 1, 
              url: 'https://images.unsplash.com/photo-1544027993-37dbfe43562a?w=800&h=600&fit=crop&q=80', 
              description: { zh: 'å’Œå¥½æœ‹å‹çš„åˆç…§', en: 'Photo with good friends' },
              isDefault: true
            },
            { 
              id: 2, 
              url: 'https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=800&h=600&fit=crop&q=80', 
              description: { zh: 'åˆä¸­æ—¶å…‰', en: 'Middle school days' },
              isDefault: true
            },
            { 
              id: 3, 
              url: 'https://images.unsplash.com/photo-1511988617509-a57c8a288659?w=800&h=600&fit=crop&q=80', 
              description: { zh: 'æ¸©æš–çš„å›å¿†', en: 'Warm memories' },
              is
